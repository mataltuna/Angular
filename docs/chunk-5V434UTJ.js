import{a as $t}from"./chunk-BYURTOAD.js";import{a as it,b as Qt}from"./chunk-DYBMCYVM.js";import{a as Ct}from"./chunk-NANYRVL3.js";import{a as kt}from"./chunk-5HLJYOOY.js";import{a as St}from"./chunk-YWYD2KRV.js";import{A as vt,B as xt,C as bt,D as Dt,E as Et,F as Mt,G as wt,H as It,I as Ut,J as yt,K as Tt,L as Rt,M as Ft,N as Nt,O as At,P as Ot,Q as Lt,R as Vt,S as jt,T as j,U as Bt,a as et,d as M,e as nt,h as ot,j as rt,k as h,l as at,m as st,n as lt,p as mt,q as dt,r as ut,s as ct,t as pt,u as ft,w as _t,x as gt,z as ht}from"./chunk-LQYVKD47.js";import"./chunk-Q64FFBLU.js";import{a as Z,h as V,j as tt,m as H}from"./chunk-C353KNEH.js";import{Bb as m,Fa as v,Fb as K,Ga as S,Gb as u,J as q,Lb as _,Mb as n,Nb as o,Ob as f,Pb as D,Qb as E,Sb as I,Uc as L,Vb as g,Vc as W,Xb as C,Xc as X,_c as Y,a as T,b as z,e as Jt,f as R,fc as r,gc as x,hc as c,jb as s,ka as J,kb as d,kc as A,la as F,lc as O,pa as Q,va as b,wa as N}from"./chunk-THA4BGIW.js";function Xt(t,i){t&1&&r(0," Este campo es requerido ")}function Yt(t,i){t&1&&r(0," Este campo debe tener 3 caracteres como m\xEDnimo ")}function Zt(t,i){t&1&&r(0," Este campo es requerido ")}function te(t,i){t&1&&r(0," Este campo debe tener 3 caracteres como m\xEDnimo ")}function ee(t,i){if(t&1&&(n(0,"mat-option",15),r(1),o()),t&2){let e=i.$implicit;u("value",e.name),s(),x(e.name)}}function ie(t,i){t&1&&r(0," Este campo es requerido ")}function ne(t,i){t&1&&r(0," Este campo es requerido ")}function oe(t,i){t&1&&r(0,"Este campo debe tener un formato de correo electronico")}var B=class t{constructor(i,e,a,l){this.matDialogRef=i;this.formBuilder=e;this.coursesService=a;this.data=l;this.studentForm=this.formBuilder.group({firstName:["",[h.required,h.minLength(3)]],lastName:["",[h.required,h.minLength(3)]],email:["",[h.required,h.email]],courses:["",[h.required]]}),this.courses$=this.coursesService.getCourses(),this.patchFormValue()}passwdInpType="password";studentForm;courses$;get isEditing(){return!!this.data?.editingStudent}patchFormValue(){this.data?.editingStudent&&this.studentForm.patchValue(this.data.editingStudent)}onAdd(){this.studentForm.invalid?this.studentForm.markAllAsTouched():this.matDialogRef.close(z(T({},this.studentForm.value),{token:this.isEditing?this.data.editingStudent.id:St(20)}))}togglePasswdInpType(){this.passwdInpType==="password"?this.passwdInpType="text":this.passwdInpType="password"}static \u0275fac=function(e){return new(e||t)(d(bt),d(ct),d($t),d(Dt))};static \u0275cmp=b({type:t,selectors:[["app-user-dialog"]],decls:44,vars:10,consts:[["mat-dialog-title",""],["mat-dialog-content","","id","dialogContent"],["id","user-form",3,"formGroup"],["id","topRow",1,"row"],[1,"col-6"],["appearance","outline"],["formControlName","firstName","matInput","","placeholder","Ej: Juan"],["formControlName","lastName","matInput","","placeholder","Ej: Perez"],[1,"row"],["formControlName","courses","multiple",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","email","matInput","","placeholder","Ej: tumail@example.com","required",""],["mat-dialog-actions",""],["mat-dialog-close","","mat-button",""],["mat-button","",3,"click"],[3,"value"]],template:function(e,a){if(e&1&&(n(0,"h4",0),r(1),o(),n(2,"div",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),r(8,"Nombre"),o(),f(9,"input",6),n(10,"mat-error"),m(11,Xt,1,0)(12,Yt,1,0),o()()(),n(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),r(16,"Apellido"),o(),f(17,"input",7),n(18,"mat-error"),m(19,Zt,1,0)(20,te,1,0),o()()()(),n(21,"div",8)(22,"div",4)(23,"mat-form-field",5)(24,"mat-label"),r(25,"Curso"),o(),n(26,"mat-select",9),m(27,ee,2,2,"mat-option",10),A(28,"async"),o(),n(29,"mat-error"),m(30,ie,1,0),o()()(),n(31,"div",4)(32,"mat-form-field",5)(33,"mat-label"),r(34,"Correo electronico"),o(),f(35,"input",11),n(36,"mat-error"),m(37,ne,1,0)(38,oe,1,0),o()()()()()(),n(39,"div",12)(40,"button",13),r(41,"Cancelar"),o(),n(42,"button",14),g("click",function(){return a.onAdd()}),r(43),o()()),e&2){let l,p,G,y;s(),c("",a.data!=null&&a.data.editingStudent?"Edita al ":"A\xF1ade un "," estudiante "),s(2),u("formGroup",a.studentForm),s(8),_((l=a.studentForm.get("firstName"))!=null&&l.hasError("required")?11:(l=a.studentForm.get("firstName"))!=null&&l.hasError("minlength")?12:-1),s(8),_((p=a.studentForm.get("lastName"))!=null&&p.hasError("required")?19:(p=a.studentForm.get("lastName"))!=null&&p.hasError("minlength")?20:-1),s(8),u("ngForOf",O(28,8,a.courses$)),s(3),_((G=a.studentForm.get("courses"))!=null&&G.hasError("required")?30:-1),s(7),_((y=a.studentForm.get("email"))!=null&&y.hasError("required")?37:(y=a.studentForm.get("email"))!=null&&y.hasError("email")?38:-1),s(6),x(a.data!=null&&a.data.editingStudent?"Editar":"A\xF1adir")}},dependencies:[L,lt,rt,at,st,ut,mt,dt,M,Mt,wt,Ut,It,ht,_t,gt,vt,xt,et,X],styles:["#user-form[_ngcontent-%COMP%]{padding:4px 0}#user-form[_ngcontent-%COMP%]   #topRow[_ngcontent-%COMP%]{margin-bottom:5px}"]})};var Gt=Jt(Qt());var w=class t{constructor(i){this.httpsClient=i}baseURL=it.apiBaseURL;getById(i){return this.httpsClient.get(`${this.baseURL}/students/${i}`)}getStudents(){return this.httpsClient.get(`${this.baseURL}/students`)}removeStudById(i){return this.httpsClient.delete(`${this.baseURL}/students/${i}`).pipe(q(()=>this.getStudents()))}createStudent(i){return this.httpsClient.post(`${this.baseURL}/students`,T({},i))}updateStudById(i,e){return this.httpsClient.patch(`${this.baseURL}/students/${i}`,e).pipe(q(()=>this.getStudents()))}static \u0275fac=function(e){return new(e||t)(Q(Z))};static \u0275prov=J({token:t,factory:t.\u0275fac,providedIn:"root"})};function se(t,i){t&1&&(n(0,"div",2),f(1,"mat-spinner"),n(2,"h3"),r(3,"Cargando, por favor espere..."),o()())}function le(t,i){t&1&&(n(0,"th",14),r(1," ID. "),o())}function me(t,i){if(t&1&&(n(0,"td",15),r(1),o()),t&2){let e=i.$implicit;s(),c(" ",e.id," ")}}function de(t,i){t&1&&(n(0,"th",14),r(1," Nombre "),o())}function ue(t,i){if(t&1&&(n(0,"td",15),r(1),A(2,"userFullName"),o()),t&2){let e=i.$implicit;s(),c(" ",O(2,1,e)," ")}}function ce(t,i){t&1&&(n(0,"th",14),r(1," Correo electronico "),o())}function pe(t,i){if(t&1&&(n(0,"td",15),r(1),o()),t&2){let e=i.$implicit;s(),c(" ",e.email," ")}}function fe(t,i){t&1&&(n(0,"th",14),r(1," Cursos "),o())}function Ce(t,i){if(t&1&&(n(0,"td",15),r(1),o()),t&2){let e=i.$implicit;s(),x(e.courses)}}function _e(t,i){t&1&&(n(0,"th",14),r(1," Acciones "),o())}function ge(t,i){if(t&1){let e=I();n(0,"td",15)(1,"button",16),g("click",function(){let l=v(e).$implicit,p=C(2);return S(p.goToDetail(l.id))}),n(2,"mat-icon"),r(3," visibility "),o()(),n(4,"button",16),g("click",function(){let l=v(e).$implicit,p=C(2);return S(p.openModal(l))}),n(5,"mat-icon"),r(6," edit "),o()(),n(7,"button",16),g("click",function(){let l=v(e).$implicit,p=C(2);return S(p.onDelete(l.id))}),n(8,"mat-icon"),r(9," delete "),o()()()}}function he(t,i){t&1&&f(0,"tr",17)}function ve(t,i){t&1&&f(0,"tr",18)}function Se(t,i){if(t&1){let e=I();n(0,"button",3),g("click",function(){v(e);let l=C();return S(l.openModal())}),n(1,"mat-icon"),r(2,"add"),o(),r(3," A\xF1adir alumno "),o(),n(4,"table",4),D(5,5),m(6,le,2,0,"th",6)(7,me,2,1,"td",7),E(),D(8,8),m(9,de,2,0,"th",6)(10,ue,3,3,"td",7),E(),D(11,9),m(12,ce,2,0,"th",6)(13,pe,2,1,"td",7),E(),D(14,10),m(15,fe,2,0,"th",6)(16,Ce,2,1,"td",7),E(),D(17,11),m(18,_e,2,0,"th",6)(19,ge,10,0,"td",7),E(),m(20,he,1,0,"tr",12)(21,ve,1,0,"tr",13),o()}if(t&2){let e=C();s(4),u("dataSource",e.dataSource),s(16),u("matHeaderRowDef",e.displayedColumns),s(),u("matRowDefColumns",e.displayedColumns)}}var $=class t{constructor(i,e,a,l){this.matDialog=i;this.studentsService=e;this.router=a;this.activatedRoute=l}displayedColumns=["id","name","email","courses","actions"];dataSource=[];isLoading=!1;isAdmin=!1;user=null;authService;ngOnInit(){this.loadStuds()}loadStuds(){this.isLoading=!0,this.studentsService.getStudents().subscribe({next:i=>{this.dataSource=i},error:()=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}onDelete(i){return R(this,null,function*(){(yield this.showConfirmationDialog("eliminar el alumno")).isConfirmed&&(this.isLoading=!0,this.studentsService.removeStudById(i).subscribe({next:a=>{this.dataSource=a},error:a=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}}))})}goToDetail(i){this.router.navigate([i,"detail"],{relativeTo:this.activatedRoute})}openModal(i){this.matDialog.open(B,{data:{editingStudent:i}}).afterClosed().subscribe({next:e=>R(this,null,function*(){e&&(i?(yield this.showConfirmationDialog("guardar los cambios")).isConfirmed&&this.handleUpdate(i.id,e):(this.isLoading=!0,this.studentsService.createStudent(e).subscribe({next:()=>this.loadStuds()})))})})}showConfirmationDialog(i){return R(this,null,function*(){return yield Gt.default.fire({title:`\xBFQuieres ${i}?`,showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"})})}handleUpdate(i,e){this.isLoading=!0,this.studentsService.updateStudById(i,e).subscribe({next:a=>{this.dataSource=a},error:a=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}static \u0275fac=function(e){return new(e||t)(d(Et),d(w),d(tt),d(V))};static \u0275cmp=b({type:t,selectors:[["app-users"]],decls:5,vars:1,consts:[["id","users-container",1,"contContainer"],["appHighlight",""],[1,"loading-msg"],["mat-raised-button","",1,"btnModal",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["appHighlight","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","courses"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["appHighlight","","mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){e&1&&(n(0,"div",0)(1,"h2",1),r(2,"Alumnos"),o(),m(3,se,4,0,"div",2)(4,Se,22,3),o()),e&2&&(s(3),_(a.isLoading?3:4))},dependencies:[j,M,nt,ot,yt,Rt,Ot,Ft,Tt,Lt,Nt,At,Vt,jt,kt,Ct],styles:["#users-container[_ngcontent-%COMP%]   #btnModal[_ngcontent-%COMP%]{margin-bottom:1rem}"]})};function xe(t,i){t&1&&(n(0,"div",1),f(1,"mat-spinner"),n(2,"h3"),r(3,"Cargando, por favor espere..."),o()())}function be(t,i){if(t&1&&(n(0,"mat-list-item",6),r(1),o()),t&2){let e=i.$implicit;s(),x(e)}}function De(t,i){if(t&1){let e=I();n(0,"div",7)(1,"button",8),g("click",function(){v(e);let l=C(2);return S(l.toggleCourseVisibility())}),r(2),o()()}if(t&2){let e=C(2);s(),K("aria-expanded",e.showAllCourses),s(),c(" ",e.showAllCourses?"Ocultar":"Ver m\xE1s cursos"," ")}}function Ee(t,i){if(t&1&&(n(0,"h1"),r(1),o(),n(2,"mat-list",2)(3,"mat-list-item",3)(4,"span"),r(5,"Id:"),o(),r(6),o(),n(7,"mat-list-item",3)(8,"span"),r(9,"Correo Electronico:"),o(),r(10),o(),n(11,"mat-list-item",3)(12,"span"),r(13,"Cursos(actuales):"),o()(),m(14,be,2,1,"mat-list-item",4)(15,De,3,2,"div",5),o()),t&2){let e=C();s(),c("Detalle del usuario: ",(e.student==null?null:e.student.firstName)+" "+(e.student==null?null:e.student.lastName),""),s(5),c(" ",e.student==null?null:e.student.id,""),s(4),c(" ",e.student==null?null:e.student.email,""),s(4),u("ngForOf",e.displayedCourses),s(),u("ngIf",e.hasMultipleCourses())}}var k=class t{constructor(i,e){this.activatedRoute=i;this.studentsService=e;this.idStudent=i.snapshot.params.id}idStudent;student;isLoading=!1;showAllCourses=!0;displayedCourses=[];ngOnInit(){this.isLoading=!0,this.studentsService.getById(this.activatedRoute.snapshot.params.id).subscribe({next:i=>{this.student=i,this.isLoading=!1,this.toggleCourseVisibility()},error:()=>{this.isLoading=!1}})}toggleCourseVisibility(){this.showAllCourses=!this.showAllCourses,this.displayedCourses=this.showAllCourses?this.student?.courses||[]:this.student?.courses.slice(0,2)||[]}hasMultipleCourses(){return(this.student?.courses?.length||0)>2}static \u0275fac=function(e){return new(e||t)(d(V),d(w))};static \u0275cmp=b({type:t,selectors:[["app-user-detail"]],decls:3,vars:1,consts:[[1,"contContainer"],[1,"loading-msg"],["role","list"],["role","listitem",1,"li-ttl"],["role","listitem",4,"ngFor","ngForOf"],["role","listitem","class","demo-section",4,"ngIf"],["role","listitem"],["role","listitem",1,"demo-section"],["mat-raised-button","",3,"click"]],template:function(e,a){e&1&&(n(0,"div",0),m(1,xe,4,0,"div",1)(2,Ee,16,5),o()),e&2&&(s(),_(a.isLoading?1:2))},dependencies:[L,W,j,M,pt,ft],styles:["mat-list[_ngcontent-%COMP%]   .li-ttl[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;color:#3b5166}"]})};var Me=[{path:"",component:$},{path:":id/detail",component:k}],P=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=N({type:t});static \u0275inj=F({imports:[H.forChild(Me),H]})};var zt=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=N({type:t});static \u0275inj=F({imports:[Y,P,Bt]})};export{zt as UsersModule};
