import{a as Se}from"./chunk-BYURTOAD.js";import{b as we}from"./chunk-DYBMCYVM.js";import{a as ve}from"./chunk-5HLJYOOY.js";import{a as te}from"./chunk-YWYD2KRV.js";import{A as ee,C as ie,D as oe,E as ne,F as ae,G as re,H as se,I as le,J as me,K as de,L as ue,M as ce,N as pe,O as Ce,P as fe,Q as _e,R as ge,S as he,T as xe,U as De,d as w,e as $,h as q,j as O,k as F,l as P,m as U,n as z,o as Q,p as X,q as J,s as K,w as W,x as Y,z as Z}from"./chunk-LQYVKD47.js";import"./chunk-Q64FFBLU.js";import{m as A}from"./chunk-C353KNEH.js";import{Bb as m,Fa as M,Ga as b,Gb as C,Lb as h,Mb as o,Nb as a,Ob as c,Pb as f,Qb as _,Sb as R,Vb as g,Xb as x,Yc as H,_c as G,a as N,b as L,e as be,f as D,fc as r,gc as B,hc as p,jb as s,kb as u,kc as j,la as S,lc as k,va as v,wa as E}from"./chunk-THA4BGIW.js";function ye(e,t){e&1&&r(0," Este campo es requerido ")}function Re(e,t){e&1&&r(0," Este campo debe tener 4 caracteres como m\xEDnimo ")}function Ae(e,t){e&1&&r(0," Este campo es requerido ")}function Ve(e,t){e&1&&r(0," Este campo no puede tener m\xE1s de 90 alumnos ")}var T=class e{constructor(t,i,n){this.formBuilder=t;this.matDialogRef=i;this.data=n;this.courseForm=this.formBuilder.group({name:["",[F.required,F.minLength(4)]],maxStud:["",[F.required,this.maxStudValidator(90)]]}),this.patchFormValue()}courseForm;get isEditing(){return!!this.data?.editingCourse}patchFormValue(){this.data?.editingCourse&&this.courseForm.patchValue(this.data.editingCourse)}onAdd(){this.courseForm.invalid?this.courseForm.markAllAsTouched():this.matDialogRef.close(L(N({},this.courseForm.value),{id:this.isEditing?this.data.editingCourse.id:te(4),createdAt:this.isEditing?this.data.editingCourse.createdAt:new Date}))}maxStudValidator(t){return i=>{let n=i.value;return n&&n>t?{maxStudExceeded:{max:t}}:null}}static \u0275fac=function(i){return new(i||e)(u(K),u(ie),u(oe))};static \u0275cmp=v({type:e,selectors:[["app-courses-dialog"]],decls:26,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content","","id","dialogContent"],["id","course-form",3,"formGroup"],["id","topRow",1,"row"],[1,"col-6","mb-3"],["appearance","outline",1,"w-100"],["formControlName","name","matInput","","placeholder","Ej: Dise\xF1o UX UI"],[1,"col-6"],["appearance","outline"],["type","number","formControlName","maxStud","matInput","","placeholder","Ej: 30"],["mat-dialog-actions",""],["mat-dialog-close","","mat-button",""],["mat-button","",3,"click"]],template:function(i,n){if(i&1&&(o(0,"h4",0),r(1),a(),o(2,"div",1)(3,"form",2)(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),r(8,"Nombre"),a(),c(9,"input",6),o(10,"mat-error"),m(11,ye,1,0)(12,Re,1,0),a()()(),o(13,"div",7)(14,"mat-form-field",8)(15,"mat-label"),r(16,"Maximo de alumnos"),a(),c(17,"input",9),o(18,"mat-error"),m(19,Ae,1,0)(20,Ve,1,0),a()()()()()(),o(21,"div",10)(22,"button",11),r(23,"Cancelar"),a(),o(24,"button",12),g("click",function(){return n.onAdd()}),r(25),a()()),i&2){let l,d;s(),p("",n.data!=null&&n.data.editingCourse?"Edita el ":"A\xF1ade un ","curso "),s(2),C("formGroup",n.courseForm),s(8),h((l=n.courseForm.get("name"))!=null&&l.hasError("required")?11:(l=n.courseForm.get("name"))!=null&&l.hasError("minlength")?12:-1),s(8),h((d=n.courseForm.get("maxStud"))!=null&&d.hasError("required")?19:(d=n.courseForm.get("maxStud"))!=null&&d.hasError("maxStudExceeded")?20:-1),s(6),B(n.data!=null&&n.data.editingCourse?"Editar":"A\xF1adir")}},dependencies:[z,O,Q,P,U,X,J,w,ae,re,le,se,Z,W,Y,ee],styles:["#course-form[_ngcontent-%COMP%]{padding:4px 0;width:auto}"]})};var Ee=be(we());function Ne(e,t){e&1&&(o(0,"div",2),c(1,"mat-spinner"),o(2,"h3"),r(3,"Cargando, por favor espere..."),a()())}function Le(e,t){e&1&&(o(0,"th",14),r(1," ID. "),a())}function Be(e,t){if(e&1&&(o(0,"td",15),r(1),a()),e&2){let i=t.$implicit;s(),p(" ",i.id," ")}}function je(e,t){e&1&&(o(0,"th",14),r(1," Nombre "),a())}function ke(e,t){if(e&1&&(o(0,"td",15),r(1),a()),e&2){let i=t.$implicit;s(),p(" ",i.name," ")}}function He(e,t){e&1&&(o(0,"th",14),r(1," Fecha de creaci\xF3n "),a())}function Ge(e,t){if(e&1&&(o(0,"td",15),r(1),j(2,"date"),a()),e&2){let i=t.$implicit;s(),p(" ",k(2,1,i.createdAt)," ")}}function $e(e,t){e&1&&(o(0,"th",14),r(1," Maximo de Alumnos "),a())}function qe(e,t){if(e&1&&(o(0,"td",15),r(1),a()),e&2){let i=t.$implicit;s(),p(" ",i.maxStud," ")}}function Oe(e,t){e&1&&(o(0,"th",14),r(1," Acciones "),a())}function Pe(e,t){if(e&1){let i=R();o(0,"td",15)(1,"button",16),g("click",function(){let l=M(i).$implicit,d=x(2);return b(d.openModal(l))}),o(2,"mat-icon"),r(3," edit "),a()(),o(4,"button",16),g("click",function(){let l=M(i).$implicit,d=x(2);return b(d.onDelete(l.id))}),o(5,"mat-icon"),r(6," delete "),a()()()}}function Ue(e,t){e&1&&c(0,"tr",17)}function ze(e,t){e&1&&c(0,"tr",18)}function Qe(e,t){if(e&1){let i=R();o(0,"button",3),g("click",function(){M(i);let l=x();return b(l.openModal())}),o(1,"mat-icon"),r(2,"add"),a(),r(3," A\xF1adir curso "),a(),o(4,"table",4),f(5,5),m(6,Le,2,0,"th",6)(7,Be,2,1,"td",7),_(),f(8,8),m(9,je,2,0,"th",6)(10,ke,2,1,"td",7),_(),f(11,9),m(12,He,2,0,"th",6)(13,Ge,3,3,"td",7),_(),f(14,10),m(15,$e,2,0,"th",6)(16,qe,2,1,"td",7),_(),f(17,11),m(18,Oe,2,0,"th",6)(19,Pe,7,0,"td",7),_(),m(20,Ue,1,0,"tr",12)(21,ze,1,0,"tr",13),a()}if(e&2){let i=x();s(4),C("dataSource",i.dataSource),s(16),C("matHeaderRowDef",i.displayedColumns),s(),C("matRowDefColumns",i.displayedColumns)}}var I=class e{constructor(t,i){this.coursesService=t;this.matDialog=i}dataSource=[];displayedColumns=["id","name","maxStud","createdAt","actions"];isLoading=!1;ngOnInit(){this.loadCourses()}loadCourses(){this.isLoading=!0,this.coursesService.getCourses().subscribe({next:t=>{this.dataSource=t},error:()=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}onDelete(t){return D(this,null,function*(){(yield this.showConfirmationDialog("eliminar el alumno")).isConfirmed&&(this.isLoading=!0,this.coursesService.removeCourById(t).subscribe({next:n=>{this.dataSource=n},error:n=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}}))})}openModal(t){this.matDialog.open(T,{data:{editingCourse:t}}).afterClosed().subscribe({next:i=>D(this,null,function*(){i&&(t?(yield this.showConfirmationDialog("guardar los cambios")).isConfirmed&&this.handleUpdate(t.id,i):(this.isLoading=!0,this.coursesService.createCourse(i).subscribe({next:()=>this.loadCourses()})))})})}showConfirmationDialog(t){return D(this,null,function*(){return yield Ee.default.fire({title:`\xBFQuieres ${t}?`,showDenyButton:!0,confirmButtonText:"Confirmar",denyButtonText:"Cancelar"})})}handleUpdate(t,i){this.isLoading=!0,this.coursesService.updateCourById(t,i).subscribe({next:n=>{this.dataSource=n},error:n=>{this.isLoading=!1},complete:()=>{this.isLoading=!1}})}static \u0275fac=function(i){return new(i||e)(u(Se),u(ne))};static \u0275cmp=v({type:e,selectors:[["app-courses"]],decls:5,vars:1,consts:[[1,"contContainer"],["appHighlight",""],[1,"loading-msg"],["mat-raised-button","",1,"btnModal",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["appHighlight","","mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","createdAt"],["matColumnDef","maxStud"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["appHighlight","","mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h2",1),r(2,"Cursos"),a(),m(3,Ne,4,0,"div",2)(4,Qe,22,3),a()),i&2&&(s(3),h(n.isLoading?3:4))},dependencies:[xe,w,$,q,me,ue,fe,ce,de,_e,pe,Ce,ge,he,ve,H]})};var Xe=[{path:"",component:I}],y=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=E({type:e});static \u0275inj=S({imports:[A.forChild(Xe),A]})};var Me=class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=E({type:e});static \u0275inj=S({imports:[G,y,De]})};export{Me as CoursesModule};
